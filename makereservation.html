<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make a reservation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
</head>
<body>
    <br>
    <div class="input-group mb-3">
        <span class="input-group-text" >Forename</span>
        <input id="firstName" type="text" class="form-control" placeholder="First name" aria-label="guest's first name" aria-describedby="basic-addon1">
        <span class="input-group-text" >Surname</span>
        <input id="lastName" type="text" class="form-control" placeholder="Last Name" aria-label="guest's last name" aria-describedby="basic-addon2">
      </div>

      <div class="input-group mb-3">
        <label class="input-group-text" for="amountPeople">Amount of people</label>
        <select class="form-select" id="amountPeople">
          <option selected>1</option>
          <option value="1">One</option>
          <option value="2">Two</option>
          <option value="3">Three</option>
          <option value="4">Four</option>
          <option value="5">Five</option>
          <option value="6">Six</option>
          <option value="7">Seven</option>
          <option value="8">Eight</option>
        </select>
      </div>
      
      <div class="input-group mb-3">
        <span class="input-group-text" >Start date</span>
        <input id="beginDate" type="date" class="form-control" aria-label="guest's begin date" aria-describedby="basic-addon2">
        <span class="input-group-text" >End date</span>
        <input id="endDate" type="date" class="form-control" aria-label="guest's end date" aria-describedby="basic-addon2">
      </div>

      <div class="input-group mb-3">
        <span class="input-group-text" id="basic-addon2">Phone Number</span>
        <input type="number" class="form-control" placeholder="31 06 4444444" aria-label="guest's phone number" aria-describedby="basic-addon3">
      </div>

      <div class="form-check">
        <input class="form-check-input" type="checkbox" value="" id="breakfastCheck">
        <label class="form-check-label" for="breakfastCheck">
          Added Breakfast +$3.50
        </label>
      </div>

      <div class="form-check">
        <input class="form-check-input" type="checkbox" value="" id="businessCheck">
        <label class="form-check-label" for="businessCheck">
          Business stay
        </label>
      </div>
      <br>
      <!-- Button trigger modal -->
<button type="button" onclick="reserveR()" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
    Place reservation
  </button>
  
  <!-- Modal -->
  <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">Modal title</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Reservation placed for guest 
        </div>
        <div class="modal-footer">
          <button type="button" onclick="bookPayAtHotelR(1)" class="btn btn-secondary" data-bs-dismiss="modal">Pay at hotel</button>
          <button type="button" onclick="bookR(1)" class="btn btn-primary" data-bs-dismiss="modal">Pay now</button>
        </div>
      </div>
    </div>
  </div>
    <script>
        function reserveR(){
            var reservation = {};
            reservation.id=1;
            reservation.amountPeople = document.getElementById("amountPeople").value;
            reservation.roomNumber = 4;
            reservation.beginDate = document.getElementById("beginDate").value;
            reservation.endDate = document.getElementById("endDate").value;
            reservation.breakfast = document.getElementById("breakfastCheck").checked;
            reservation.business = document.getElementById("businessCheck").checked;

            var theJSON = JSON.stringify(reservation);
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function(){
                if(this.readyState == 4){
                    console.log("reservation succesful")
                    console.log(theJSON)
                }
            }

            xhr.open("POST", "http://localhost:8080/addreservation", true)
            xhr.setRequestHeader("Content-Type","application/json");
            xhr.send(theJSON);

        }
        function bookR(theid){

            addGuest();
            
            var reservation = {};
            reservation.id = theid;
            paymentStatus = true;

            var theJSON = JSON.stringify(reservation);
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function(){
                if(this.readyState == 4){
                    console.log("approve succesful")
                }
            }
            xhr.open("PUT", "http://localhost:8080/approvereservation/"+paymentStatus, true)
            xhr.setRequestHeader("Content-Type","application/json");
            xhr.send(theid);
        }

        function bookPayAtHotelR(theid){
            addGuest();
            
            var reservation = {};
            reservation.id = theid;
            paymentStatus = false;

            var theJSON = JSON.stringify(reservation);
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function(){
                if(this.readyState == 4){
                    console.log("approve succesful")
                }
            }
            xhr.open("PUT", "http://localhost:8080/approvereservation/"+paymentStatus, true)
            xhr.setRequestHeader("Content-Type","application/json");
            xhr.send(theid);
        }

        function addGuest(){
            var guest = {};
            guest.firstName = document.getElementById("firstName").value;
            guest.lastName = document.getElementById("lastName").value;

            var theJSON = JSON.stringify(guest);
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function(){
                if(this.readyState == 4){
                    console.log("Guest added succesfully")
                    console.log(theJSON)
                }
            }

            xhr.open("POST", "http://localhost:8080/addcustomer", true)
            xhr.setRequestHeader("Content-Type","application/json");
            xhr.send(theJSON);

        }

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
</body>
</html>